# デプロイメントガイド

## 本番環境用ビルド

1. 拡張機能をビルドする（Chrome + Firefox）：
```bash
yarn build
```

`dist/`（Chrome 用）と `dist-firefox/`（Firefox 用）が生成されます。
Chrome だけ、あるいは Firefox だけを個別に更新する場合は `yarn build:chrome` / `yarn build:firefox` を使用します。

2. 配布パッケージを作成する：
```bash
yarn package
```

`packages/` ディレクトリに以下の ZIP が作成されます。
- `multi-ai-translator-chrome.zip`（Chrome / Edge 用）
- `multi-ai-translator-firefox.zip`（Firefox 用）

## Chrome ウェブストア

### 前提条件
- Googleアカウント
- 5ドルの1回限りの開発者登録料
- 準備済みのアセット（アイコン、スクリーンショット、説明文）

### 手順

1. **開発者として登録**
   - [Chrome ウェブストア デベロッパー ダッシュボード](https://chrome.google.com/webstore/devconsole)にアクセス
   - 登録料（5ドル）を支払う
   - 利用規約に同意する

2. **アセットの準備**

   必要なアイコン：
   - 128x128 アイコン（必須）
   - スクリーンショット：1280x800 または 640x400（最低1枚、最大5枚）
   - プロモーション画像（オプション）：
     - 小サイズ：440x280
     - マーキー：1400x560

3. **新規アイテムの作成**
   - 「新規アイテム」をクリック
   - `packages/multi-ai-translator-chrome.zip` をアップロード
   - 自動チェックを待つ

4. **ストアリストの記入**

   必須フィールド：
   - **名前**：Multi-AI Translator
   - **概要**：複数のAIプロバイダーを使用してウェブページを翻訳
   - **説明**：下記のテンプレートを参照
   - **カテゴリ**：生産性
   - **言語**：日本語

   説明文テンプレート：
   ```
   Multi-AI Translatorは、OpenAI、Claude、Gemini、Ollamaなど、複数のAIプロバイダーを
   使用してウェブページを翻訳できる強力なブラウザ拡張機能です。

   主な機能：
   • 複数のAIプロバイダーに対応
   • ページ全体または選択したテキストの翻訳
   • ポップアップでの翻訳表示
   • 元のコンテンツの復元
   • カスタマイズ可能な設定
   • 多言語UI（英語、日本語）

   対応プロバイダー：
   • OpenAI（GPT-3.5、GPT-4）
   • Claude（Anthropic）
   • Gemini（Google）
   • Ollama（ローカル）
   • OpenAI互換API

   プライバシー：
   この拡張機能は個人データを一切収集しません。すべてのAPIキーはブラウザに
   ローカルで保存されます。翻訳リクエストは選択したAIプロバイダーに直接送信されます。
   ```

5. **プライバシー設定**
   - プライバシーポリシーを追加（ネットワークリクエストを使用する場合は必須）
   - データ使用について説明
   - 権限の正当性を説明

   プライバシーポリシーテンプレート：
   ```
   Multi-AI Translator のプライバシーポリシー

   データ収集：
   この拡張機能は、個人情報を収集、保存、送信することはありません。

   APIキー：
   すべてのAPIキーは、Chromeのストレージ APIを使用してブラウザにローカルで保存されます。
   キーが当社のサーバーに送信されることはありません。

   翻訳データ：
   翻訳リクエストは、選択したAIプロバイダー（OpenAI、Claudeなど）に直接送信されます。
   当社は翻訳コンテンツを傍受または保存することはありません。

   権限：
   • storage：設定をローカルに保存するため
   • activeTab：翻訳のためにページコンテンツにアクセスするため
   • <all_urls>：任意のウェブページを翻訳するため
   ```

6. **審査用に提出**
   - すべての情報を確認
   - 「審査用に提出」をクリック
   - 承認まで1〜3日待つ

### 承認後

- 拡張機能が自動的に公開される
- レビューとフィードバックを監視
- ユーザーの問題に対応

## Microsoft Edge アドオン

### 前提条件
- Microsoftアカウント
- 登録料不要
- 準備済みのアセット

### 手順

1. **登録**
   - [パートナーセンター](https://partner.microsoft.com/dashboard)にアクセス
   - Microsoftアカウントでサインイン
   - 登録を完了

2. **拡張機能を提出**
   - 「新しい拡張機能」をクリック
   - `packages/multi-ai-translator-chrome.zip` をアップロード（Edge も Chrome ビルドを使用）
   - 必須フィールドを記入（Chromeと同様）

3. **審査プロセス**
   - 通常1〜7日
   - Chromeよりも徹底的
   - 変更を求められる場合がある

## 拡張機能の更新

1. **`manifest.json` でバージョンを更新**：
```json
{
  "version": "1.0.1"
}
```

2. **ビルドしてパッケージ化**：
```bash
yarn build
yarn package
```

3. **新しいバージョンをアップロード**：
   - Chrome：既存のアイテムにアップロード
   - Edge：新しい提出を作成

4. **リリースノートを追加**：
```
バージョン 1.0.1
- 翻訳エラーハンドリングを修正
- パフォーマンスを改善
- 依存関係を更新
```

## バージョン管理

セマンティックバージョニングに従う：
- **メジャー**（1.0.0）：破壊的変更
- **マイナー**（0.1.0）：新機能
- **パッチ**（0.0.1）：バグ修正

## 配布チャネル

### 公式ストア
- ✅ Chrome ウェブストア（推奨）
- ✅ Edge アドオン（推奨）
- 🚧 Firefox アドオン（将来）

### 代替配布方法
- GitHub リリース
- ウェブサイトからの直接ダウンロード
- エンタープライズ配布

## 監視

### 追跡すべき指標
- インストール数
- アクティブユーザー数
- 評価とレビュー
- クラッシュレポート
- ユーザーフィードバック

### ツール
- Chrome ウェブストア ダッシュボード
- Edge パートナーセンター
- Google Analytics（実装されている場合）

## サポート

複数のサポートチャネルを提供：
- GitHub Issues
- メールサポート
- ドキュメンテーション wiki
- FAQ ページ

## マーケティング

1. **ローンチアナウンス**
   - ブログ投稿
   - ソーシャルメディア
   - Product Hunt

2. **ドキュメンテーション**
   - ユーザーガイド
   - ビデオチュートリアル
   - FAQ

3. **コミュニティ**
   - Discord/Slack
   - Reddit 投稿
   - フォーラム参加

## コンプライアンス

- GDPR コンプライアンス（EUユーザーがいる場合）
- プライバシーポリシー（必須）
- 利用規約
- ライセンス（MIT推奨）

## ロールバック計画

重大な問題が発生した場合：

1. **即時対応**：
   - 一時的にストアから拡張機能を削除
   - ステータス更新を投稿

2. **修正**：
   - 問題を特定して修正
   - 徹底的にテスト
   - 審査を迅速化

3. **復旧**：
   - 修正版をアップロード
   - ユーザーに通知
   - ポストモーテム分析
